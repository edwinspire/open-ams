{"version":3,"file":"javaCheck.js","sourceRoot":"","sources":["javaCheck.ts"],"names":[],"mappings":";;;;;;;;;;;IAAA,MAAM,EAAE,IAAI,EAAE,GAAG,OAAO,CAAC,eAAe,CAAC,CAAC;IAG1C,wBAAwB,IAAc;QACrC,MAAM,EAAE,GAAG,EAAE,UAAU,EAAE,MAAM,EAAE,GAAG,IAAI,CAAC;QACzC,MAAM,CAAC,GAAG,IAAI,UAAU,IAAI,CAAE,MAAM,IAAI,IAAI,IAAI,MAAM,KAAK,OAAO,CAAC,CAAC;IACrE,CAAC;IAED,+BAA+B,GAAW;QACzC,MAAM,CAAC,GAAG,IAAI,IAAI,IAAI,GAAG,CAAC,OAAO,CAAC,cAAc,CAAC,IAAI,CAAC,CAAC;IACxD,CAAC;IAED,mBAAyB,IAAc;QACtC,MAAM,CAAC,IAAI,OAAO,CAAU,CAAC,OAAO;YACnC,EAAE,CAAC,CAAC,CAAC,cAAc,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC;gBAC3B,OAAO,CAAC,IAAI,CAAC,CAAC;YACf,CAAC;YAAC,IAAI,CAAC,CAAC;gBACP,IAAI,CAAC,eAAe,EAAE,CAAC,GAAU,EAAE,MAAc,EAAE,MAAc;oBAChE,EAAE,CAAC,CAAC,CAAC,GAAG,IAAI,CAAC,qBAAqB,CAAC,MAAM,CAAC,IAAI,qBAAqB,CAAC,MAAM,CAAC,CAAC,CAAC,CAAC,CAAC;wBAC9E,OAAO,CAAC,IAAI,CAAC,CAAC;oBACf,CAAC;oBAAC,IAAI,CAAC,CAAC;wBACP,qFAAqF;wBACrF,2EAA2E;wBAC3E,MAAM,QAAQ,GAAG,OAAO,CAAC,GAAG,CAAC,SAAS,IAAI,OAAO,CAAC,GAAG,CAAC,QAAQ,IAAI,OAAO,CAAC,GAAG,CAAC,QAAQ,CAAC;wBACvF,EAAE,CAAC,CAAC,QAAQ,CAAC,CAAC,CAAC;4BACd,IAAI,CAAC,IAAI,QAAQ,qBAAqB,EAAE,CAAC,GAAU,EAAE,MAAc,EAAE,MAAc;gCAClF,OAAO,CAAC,CAAC,GAAG,IAAI,CAAC,qBAAqB,CAAC,MAAM,CAAC,IAAI,qBAAqB,CAAC,MAAM,CAAC,CAAC,CAAC,CAAC;4BACnF,CAAC,CAAC,CAAC;wBACJ,CAAC;wBAAC,IAAI,CAAC,CAAC;4BACP,OAAO,CAAC,KAAK,CAAC,CAAC;wBAChB,CAAC;oBACF,CAAC;gBACF,CAAC,CAAC,CAAC;YACJ,CAAC;QACF,CAAC,CAAC,CAAC;IACJ,CAAC;IAvBD,4BAuBC","sourcesContent":["const { exec } = require('child_process');\nimport { TestArgs } from './main';\n\nfunction requiresTunnel(args: TestArgs) {\n\tconst { all, functional, config } = args;\n\treturn all || functional || ( config != null && config !== 'local');\n}\n\nfunction containsVersionString(str: string): boolean {\n\treturn str != null && str.indexOf('java version') >= 0;\n}\n\nexport default function (args: TestArgs) {\n\treturn new Promise<boolean>((resolve) => {\n\t\tif (!requiresTunnel(args)) {\n\t\t\tresolve(true);\n\t\t} else {\n\t\t\texec('java -version', (err: Error, stdout: string, stderr: string) => {\n\t\t\t\tif (!err && (containsVersionString(stderr) || containsVersionString(stdout))) {\n\t\t\t\t\tresolve(true);\n\t\t\t\t} else {\n\t\t\t\t\t// Dereference the environment variables here so the exec script does not have to use\n\t\t\t\t\t// an operating system specific way to dereference an environment variable.\n\t\t\t\t\tconst javaHome = process.env.JAVA_HOME || process.env.JDK_HOME || process.env.JRE_HOME;\n\t\t\t\t\tif (javaHome) {\n\t\t\t\t\t\texec(`\"${javaHome}/bin/java\" -version`, (err: Error, stdout: string, stderr: string) => {\n\t\t\t\t\t\t\tresolve(!err && (containsVersionString(stderr) || containsVersionString(stdout)));\n\t\t\t\t\t\t});\n\t\t\t\t\t} else {\n\t\t\t\t\t\tresolve(false);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t});\n}\n"]}