{"version":3,"file":"sendEvent.js","sourceRoot":"","sources":["sendEvent.ts"],"names":[],"mappings":"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","sourcesContent":["import has, { add as hasAdd } from '@dojo/core/has';\nimport { assign, deepAssign } from '@dojo/core/lang';\n\nhasAdd('customevent-constructor', () => {\n\ttry {\n\t\tnew window.CustomEvent('foo');\n\t\treturn true;\n\t}\n\tcatch (e) {\n\t\treturn false;\n\t}\n});\n\nexport type EventClass =\n\t'AnimationEvent' |\n\t'AudioProcessingEvent' |\n\t'BeforeInputEvent' |\n\t'BeforeUnloadEvent' |\n\t'BlobEvent' |\n\t'ClipboardEvent' |\n\t'CloseEvent' |\n\t'CompositionEvent' |\n\t'CSSFontFaceLoadEvent' |\n\t'CustomEvent' |\n\t'DeviceLightEvent' |\n\t'DeviceMotionEvent' |\n\t'DeviceOrientationEvent' |\n\t'DeviceProximityEvent' |\n\t'DOMTransactionEvent' |\n\t'DragEvent' |\n\t'EditingBeforeInputEvent' |\n\t'ErrorEvent' |\n\t'FetchEvent' |\n\t'FocusEvent' |\n\t'GamepadEvent' |\n\t'HashChangeEvent' |\n\t'IDBVersionChangeEvent' |\n\t'InputEvent' |\n\t'KeyboardEvent' |\n\t'MediaStreamEvent' |\n\t'MessageEvent' |\n\t'MouseEvent' |\n\t'MutationEvent' |\n\t'OfflineAudioCompletionEvent' |\n\t'PageTransitionEvent' |\n\t'PointerEvent' |\n\t'PopStateEvent' |\n\t'ProgressEvent' |\n\t'RelatedEvent' |\n\t'RTCDataChannelEvent' |\n\t'RTCIdentityErrorEvent' |\n\t'RTCIdentityEvent' |\n\t'RTCPeerConnectionIceEvent' |\n\t'SensorEvent' |\n\t'StorageEvent' |\n\t'SVGEvent' |\n\t'SVGZoomEvent' |\n\t'TimeEvent' |\n\t'TouchEvent' |\n\t'TrackEvent' |\n\t'TransitionEvent' |\n\t'UIEvent' |\n\t'UserProximityEvent' |\n\t'WebGLContextEvent' |\n\t'WheelEvent';\n\nexport interface SendEventOptions<I extends EventInit> {\n\t/**\n\t * The event class to use to create the event, defaults to `CustomEvent`\n\t */\n\teventClass?: EventClass;\n\n\t/**\n\t * An object which is used to initialise the event\n\t */\n\teventInit?: I;\n\n\t/**\n\t * A CSS selector string, used to query the target to identify the element to\n\t * dispatch the event to\n\t */\n\tselector?: string;\n}\n\nexport interface EventInitializer {\n\t(type: string, bubbles: boolean, cancelable: boolean, detail: any): void;\n}\n\n/**\n * Create and dispatch an event to an element\n * @param type The event type to dispatch\n * @param options A map of options to configure the event\n */\nexport default function sendEvent<I extends EventInit>(target: Element, type: string, options?: SendEventOptions<I>): void {\n\n\tfunction dispatchEvent(target: Element, event: Event) {\n\t\tlet error: Error | undefined;\n\n\t\tfunction catcher(e: ErrorEvent) {\n\t\t\te.preventDefault();\n\t\t\terror = e.error;\n\t\t\treturn true;\n\t\t}\n\n\t\twindow.addEventListener('error', catcher);\n\t\ttarget.dispatchEvent(event);\n\t\twindow.removeEventListener('error', catcher);\n\t\tif (error) {\n\t\t\tthrow error;\n\t\t}\n\t}\n\n\tconst {\n\t\teventClass = 'CustomEvent',\n\t\teventInit = {} as EventInit,\n\t\tselector = ''\n\t} = options || {};\n\tlet dispatchTarget: Element | undefined;\n\tif (selector) {\n\t\tconst selectorTarget = target.querySelector(selector);\n\t\tif (selectorTarget) {\n\t\t\tdispatchTarget = selectorTarget;\n\t\t}\n\t\telse {\n\t\t\tthrow new Error(`Cannot resolve to an element with selector \"${selector}\"`);\n\t\t}\n\t}\n\telse {\n\t\tdispatchTarget = target;\n\t}\n\tif (dispatchTarget) {\n\t\tlet event: CustomEvent;\n\t\tassign(eventInit, {\n\t\t\tbubbles: 'bubbles' in eventInit ? eventInit.bubbles : true,\n\t\t\tcancelable: 'cancelable' in eventInit ? eventInit.cancelable : true\n\t\t});\n\t\tconst { bubbles, cancelable, ...initProps } = eventInit;\n\t\tif (has('customevent-constructor')) {\n\t\t\tconst ctorName = eventClass in window ? eventClass : 'CustomEvent';\n\t\t\tevent = new ((<any> window)[ctorName] as typeof CustomEvent)(type, eventInit);\n\t\t}\n\t\telse {\n\t\t\t/* because the arity varies too greatly to be able to properly call all the event types, we will\n\t\t\t* only support CustomEvent for those platforms that don't support event constructors, which is\n\t\t\t* essentially IE11 */\n\t\t\tevent = dispatchTarget.ownerDocument.createEvent('CustomEvent');\n\t\t\t(event as CustomEvent).initCustomEvent(type, bubbles!, cancelable!, {});\n\t\t}\n\t\ttry {\n\t\t\tdeepAssign(event, initProps);\n\t\t}\n\t\tcatch (e) { /* swallowing assignment errors when trying to overwrite native event properties */ }\n\t\tdispatchEvent(dispatchTarget, event);\n\t}\n}\n"]}