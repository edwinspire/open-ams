{"version":3,"file":"util.js","sourceRoot":"","sources":["../../../../src/lib/common/util.ts"],"names":[],"mappings":"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","sourcesContent":["import Task from '@dojo/core/async/Task';\nimport { deepMixin, mixin } from '@dojo/core/lang';\n\nimport { Config, ResourceConfig } from './config';\nimport { Events, Executor, PluginDescriptor } from '../executors/Executor';\nimport { TextLoader } from './util';\nimport { getPathSep, join, normalize } from './path';\n\nexport interface EvaluatedProperty {\n\tname: keyof Config;\n\taddToExisting: boolean;\n}\n\nexport interface TextLoader {\n\t(path: string): Task<string>;\n}\n\nexport type TypeName =\n\t| 'string'\n\t| 'boolean'\n\t| 'number'\n\t| 'regexp'\n\t| 'object'\n\t| 'string[]'\n\t| 'object[]';\n\nexport type Parser<T = any> = (value: any) => T;\n\n/**\n * Evaluate a config property key\n */\nexport function evalProperty(key: string): EvaluatedProperty {\n\tconst addToExisting = key[key.length - 1] === '+';\n\tconst name = <keyof Config>(addToExisting\n\t\t? key.slice(0, key.length - 1)\n\t\t: key);\n\treturn { name, addToExisting };\n}\n\n/**\n * Get the base path based on a config file path and a user-supplied base path.\n *\n * The path separator will be normalized based on the separator used in\n * configFile or basePath and the optional pathSep arg.\n */\nexport function getBasePath(\n\tconfigFile: string,\n\tbasePath: string,\n\tisAbsolute: (path: string) => boolean,\n\tpathSep?: string\n) {\n\tpathSep = pathSep || getPathSep(configFile, basePath);\n\n\t// initialBasePath is the path containing the config file\n\tconst configPathParts = configFile.replace(/\\\\/g, '/').split('/');\n\tlet initialBasePath: string;\n\n\tif (configFile[0] === '/' && configPathParts.length === 2) {\n\t\tinitialBasePath = '/';\n\t} else {\n\t\tinitialBasePath = configPathParts.slice(0, -1).join('/');\n\t}\n\n\tlet finalBasePath: string;\n\n\tif (basePath) {\n\t\tbasePath = normalize(basePath);\n\n\t\tif (isAbsolute(basePath)) {\n\t\t\t// basePath is absolute, so use it directly\n\t\t\tfinalBasePath = basePath;\n\t\t} else {\n\t\t\t// basePath is relative, so resolve it against initialBasePath\n\t\t\tfinalBasePath = join(initialBasePath, basePath);\n\t\t}\n\t} else {\n\t\t// No basePath was provided, so use initialBasePath\n\t\tfinalBasePath = initialBasePath;\n\t}\n\n\treturn finalBasePath.split('/').join(pathSep);\n}\n\n/**\n * Return a string describing a config file, including any child configs.\n */\nexport function getConfigDescription(config: any, prefix = '') {\n\tlet description = '';\n\n\tif (config.description) {\n\t\tdescription += `${prefix}${config.description}\\n\\n`;\n\t}\n\n\tif (config.configs) {\n\t\tdescription += `${prefix}Configs:\\n`;\n\t\tconst width = Object.keys(config.configs).reduce((width, name) => {\n\t\t\treturn Math.max(width, name.length);\n\t\t}, 0);\n\t\tconst lines = Object.keys(config.configs).map(name => {\n\t\t\tconst child = config.configs[name];\n\t\t\twhile (name.length < width) {\n\t\t\t\tname += ' ';\n\t\t\t}\n\t\t\tlet line = `  ${name}`;\n\t\t\tif (child.description) {\n\t\t\t\tline += ` (${child.description})`;\n\t\t\t}\n\t\t\treturn `${prefix}${line}`;\n\t\t});\n\n\t\tdescription += lines.join('\\n');\n\t}\n\n\treturn description;\n}\n\n/**\n * Check if a value is a Task without directly accessing any non-existent\n * properties.\n *\n * Checking in this way is necessary when using libraries that validate property\n * accesses such as ChaiAsPromised.\n */\nexport function isTask<T = any>(value: any): value is Task<T> {\n\tif (!value || typeof value !== 'object') {\n\t\treturn false;\n\t}\n\tfor (const name of ['then', 'catch', 'finally', 'cancel']) {\n\t\tif (!(name in value) || typeof value[name] !== 'function') {\n\t\t\treturn false;\n\t\t}\n\t}\n\treturn true;\n}\n\n/**\n * Load config data from a given path, using a given text loader, and mixing\n * args and/or a childConfig into the final config value if provided.\n */\nexport function loadConfig(\n\tconfigPath: string,\n\tloadText: TextLoader,\n\targs?: { [key: string]: any },\n\tchildConfig?: string | string[]\n): Task<any> {\n\treturn _loadConfig(configPath, loadText, args, childConfig).then(config => {\n\t\t// 'config' and 'extends' are only applicable to the config loader, not\n\t\t// the Executors\n\t\tdelete config.config;\n\t\tdelete config.extends;\n\n\t\tif (!(args && (args.showConfigs || args.help))) {\n\t\t\t// 'configs' is only relevant if we're showing configs\n\t\t\tdelete config.configs;\n\t\t}\n\n\t\treturn config;\n\t});\n}\n\n/**\n * Parse an array of name=value arguments into an object\n */\nexport function parseArgs(rawArgs: string[]) {\n\tconst parsedArgs: { [key: string]: any } = {};\n\n\tfor (const arg of rawArgs) {\n\t\tlet name = arg;\n\t\tlet value: string | undefined;\n\t\tlet args = parsedArgs;\n\n\t\tconst eq = arg.indexOf('=');\n\t\tif (eq !== -1) {\n\t\t\tname = arg.slice(0, eq);\n\t\t\tvalue = arg.slice(eq + 1);\n\t\t}\n\n\t\tif (name.indexOf('.') !== -1) {\n\t\t\tconst parts = name.split('.');\n\t\t\tconst head = parts.slice(0, parts.length - 1);\n\t\t\tname = parts[parts.length - 1];\n\n\t\t\tfor (const part of head) {\n\t\t\t\tif (!args[part]) {\n\t\t\t\t\targs[part] = {};\n\t\t\t\t}\n\t\t\t\targs = args[part];\n\t\t\t}\n\t\t}\n\n\t\tif (typeof value === 'undefined') {\n\t\t\targs[name] = true;\n\t\t} else {\n\t\t\tif (!(name in args)) {\n\t\t\t\targs[name] = value;\n\t\t\t} else if (!Array.isArray(args[name])) {\n\t\t\t\targs[name] = [args[name], value];\n\t\t\t} else {\n\t\t\t\targs[name].push(value);\n\t\t\t}\n\t\t}\n\t}\n\n\treturn parsedArgs;\n}\n\n/**\n * Parse a JSON string that may contain comments\n */\nexport function parseJson(json: string) {\n\treturn JSON.parse(removeComments(json));\n}\n\n/**\n * Parse a particular type of value from a given value\n *\n * @param name The 'name' of the value being parsed (used for error messages)\n * @param value A value to parse something from\n * @param parser The type of thing to parse, or a parser function\n * @param requiredProperty Only used with 'object' and 'object[]' parsers\n */\nexport function parseValue(\n\tname: string,\n\tvalue: any,\n\tparser: TypeName | Parser,\n\trequiredProperty?: string\n) {\n\tswitch (parser) {\n\t\tcase 'boolean':\n\t\t\tif (typeof value === 'boolean') {\n\t\t\t\treturn value;\n\t\t\t}\n\t\t\tif (value === 'true') {\n\t\t\t\treturn true;\n\t\t\t}\n\t\t\tif (value === 'false') {\n\t\t\t\treturn false;\n\t\t\t}\n\t\t\tthrow new Error(`Non-boolean value \"${value}\" for ${name}`);\n\n\t\tcase 'number':\n\t\t\tconst numValue = Number(value);\n\t\t\tif (!isNaN(numValue)) {\n\t\t\t\treturn numValue;\n\t\t\t}\n\t\t\tthrow new Error(`Non-numeric value \"${value}\" for ${name}`);\n\n\t\tcase 'regexp':\n\t\t\tif (typeof value === 'string') {\n\t\t\t\treturn new RegExp(value);\n\t\t\t}\n\t\t\tif (value instanceof RegExp) {\n\t\t\t\treturn value;\n\t\t\t}\n\t\t\tthrow new Error(`Non-regexp value \"${value}\" for ${name}`);\n\n\t\tcase 'object':\n\t\t\tif (typeof value === 'string') {\n\t\t\t\ttry {\n\t\t\t\t\tvalue = value ? JSON.parse(value) : {};\n\t\t\t\t} catch (error) {\n\t\t\t\t\tif (!requiredProperty) {\n\t\t\t\t\t\tthrow new Error(\n\t\t\t\t\t\t\t`Non-object value \"${value}\" for ${name}`\n\t\t\t\t\t\t);\n\t\t\t\t\t}\n\t\t\t\t\tvalue = { [requiredProperty]: value };\n\t\t\t\t}\n\t\t\t}\n\t\t\t// A value of type 'object' should be a simple object, not a\n\t\t\t// built-in type like RegExp or Array\n\t\t\tif (Object.prototype.toString.call(value) === '[object Object]') {\n\t\t\t\tif (requiredProperty && !value[requiredProperty]) {\n\t\t\t\t\tthrow new Error(\n\t\t\t\t\t\t`Invalid value \"${JSON.stringify(value)}\" for ${\n\t\t\t\t\t\t\tname\n\t\t\t\t\t\t}: missing '${requiredProperty}' property`\n\t\t\t\t\t);\n\t\t\t\t}\n\t\t\t\treturn value;\n\t\t\t}\n\t\t\tthrow new Error(`Non-object value \"${value}\" for ${name}`);\n\n\t\tcase 'object[]':\n\t\t\tif (!value) {\n\t\t\t\tvalue = [];\n\t\t\t}\n\t\t\tif (!Array.isArray(value)) {\n\t\t\t\tvalue = [value];\n\t\t\t}\n\t\t\treturn value.map((item: any) => {\n\t\t\t\treturn parseValue(name, item, 'object', requiredProperty);\n\t\t\t});\n\n\t\tcase 'string':\n\t\t\tif (typeof value === 'string') {\n\t\t\t\treturn value;\n\t\t\t}\n\t\t\tthrow new Error(`Non-string value \"${value}\" for ${name}`);\n\n\t\tcase 'string[]':\n\t\t\tif (!value) {\n\t\t\t\tvalue = [];\n\t\t\t}\n\t\t\tif (typeof value === 'string') {\n\t\t\t\tvalue = [value];\n\t\t\t}\n\t\t\tif (\n\t\t\t\tArray.isArray(value) &&\n\t\t\t\tvalue.every(v => typeof v === 'string')\n\t\t\t) {\n\t\t\t\treturn value;\n\t\t\t}\n\t\t\tthrow new Error(`Non-string[] value \"${value}\" for ${name}`);\n\n\t\tdefault:\n\t\t\tif (typeof parser === 'function') {\n\t\t\t\treturn parser(value);\n\t\t\t} else {\n\t\t\t\tthrow new Error('Parser must be a valid type name');\n\t\t\t}\n\t}\n}\n\n/**\n * Return a string with all lines prefixed with a given prefix.\n */\nexport function prefix(message: string, prefix: string) {\n\treturn message\n\t\t.split('\\n')\n\t\t.map(line => prefix + line)\n\t\t.join('\\n');\n}\n\n/**\n * Process a Config option, transforming it to a canonical form and storing it\n * on the given config object.\n *\n * If an executor is provided, it will be used to emit deprecation and log\n * events.\n */\nexport function processOption<C extends Config>(\n\tkey: keyof C,\n\tvalue: any,\n\tconfig: C,\n\texecutor?: Executor\n) {\n\tconst { name, addToExisting } = evalProperty(key);\n\tconst emit = executor\n\t\t? (eventName: keyof Events, data?: any) => {\n\t\t\t\texecutor.emit(eventName, data);\n\t\t\t}\n\t\t: (..._args: any[]) => {};\n\n\tif (name === 'loader') {\n\t\tsetOption(config, name, parseValue(name, value, 'object', 'script'));\n\t} else if (\n\t\tname === 'bail' ||\n\t\tname === 'baseline' ||\n\t\tname === 'benchmark' ||\n\t\tname === 'debug' ||\n\t\tname === 'filterErrorStack' ||\n\t\tname === 'showConfig'\n\t) {\n\t\tsetOption(config, name, parseValue(name, value, 'boolean'));\n\t} else if (\n\t\tname === 'basePath' ||\n\t\tname === 'coverageVariable' ||\n\t\tname === 'description' ||\n\t\tname === 'internPath' ||\n\t\tname === 'name' ||\n\t\tname === 'sessionId'\n\t) {\n\t\tsetOption(config, name, parseValue(name, value, 'string'));\n\t} else if (name === 'defaultTimeout') {\n\t\tsetOption(config, name, parseValue(name, value, 'number'));\n\t} else if (name === 'grep') {\n\t\tsetOption(config, name, parseValue(name, value, 'regexp'));\n\t} else if (name === 'reporters') {\n\t\tsetOption(\n\t\t\tconfig,\n\t\t\tname,\n\t\t\tparseValue(name, value, 'object[]', 'name'),\n\t\t\taddToExisting\n\t\t);\n\t} else if (\n\t\tname === 'plugins' ||\n\t\tname === 'requires' ||\n\t\tname === 'require' ||\n\t\tname === 'scripts'\n\t) {\n\t\tlet useLoader = false;\n\t\tlet _name = name;\n\t\tif (name === 'scripts') {\n\t\t\temit('deprecated', {\n\t\t\t\toriginal: 'scripts',\n\t\t\t\treplacement: 'plugins'\n\t\t\t});\n\t\t\t_name = 'plugins';\n\t\t} else if (name === 'require') {\n\t\t\temit('deprecated', {\n\t\t\t\toriginal: 'require',\n\t\t\t\treplacement: 'plugins'\n\t\t\t});\n\t\t\t_name = 'plugins';\n\t\t} else if (name === 'requires') {\n\t\t\temit('deprecated', {\n\t\t\t\toriginal: 'require',\n\t\t\t\treplacement: 'plugins',\n\t\t\t\tmessage: 'Set `useLoader: true`'\n\t\t\t});\n\t\t\t_name = 'plugins';\n\t\t\tuseLoader = true;\n\t\t}\n\t\tconst parsed = parseValue(_name, value, 'object[]', 'script');\n\t\tif (useLoader) {\n\t\t\tparsed.forEach((entry: PluginDescriptor) => {\n\t\t\t\tentry.useLoader = true;\n\t\t\t});\n\t\t}\n\t\tsetOption(config, _name, parsed, addToExisting);\n\t} else if (name === 'suites') {\n\t\tsetOption(\n\t\t\tconfig,\n\t\t\tname,\n\t\t\tparseValue(name, value, 'string[]'),\n\t\t\taddToExisting\n\t\t);\n\t} else if (name === 'node' || name === 'browser') {\n\t\tconst envConfig: ResourceConfig = config[name] || {};\n\t\tif (!config[name]) {\n\t\t\tconfig[name] = envConfig;\n\t\t}\n\t\tconst envName = name;\n\t\tconst _value = parseValue(name, value, 'object');\n\t\tif (_value) {\n\t\t\tObject.keys(_value).forEach(valueKey => {\n\t\t\t\tconst key = <keyof ResourceConfig>valueKey;\n\t\t\t\tlet resource = _value[key];\n\t\t\t\tlet { name, addToExisting } = evalProperty(key);\n\t\t\t\tswitch (name) {\n\t\t\t\t\tcase 'loader':\n\t\t\t\t\t\tresource = parseValue(\n\t\t\t\t\t\t\tname,\n\t\t\t\t\t\t\tresource,\n\t\t\t\t\t\t\t'object',\n\t\t\t\t\t\t\t'script'\n\t\t\t\t\t\t);\n\t\t\t\t\t\tsetOption(<Config>envConfig, name, resource, false);\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 'reporters':\n\t\t\t\t\t\tresource = parseValue(\n\t\t\t\t\t\t\t'reporters',\n\t\t\t\t\t\t\tresource,\n\t\t\t\t\t\t\t'object[]',\n\t\t\t\t\t\t\t'name'\n\t\t\t\t\t\t);\n\t\t\t\t\t\tsetOption(\n\t\t\t\t\t\t\t<Config>envConfig,\n\t\t\t\t\t\t\tname,\n\t\t\t\t\t\t\tresource,\n\t\t\t\t\t\t\taddToExisting\n\t\t\t\t\t\t);\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 'plugins':\n\t\t\t\t\tcase 'require':\n\t\t\t\t\tcase 'requires':\n\t\t\t\t\tcase 'scripts':\n\t\t\t\t\t\tlet useLoader = false;\n\t\t\t\t\t\tif (name === 'scripts') {\n\t\t\t\t\t\t\temit('deprecated', {\n\t\t\t\t\t\t\t\toriginal: 'scripts',\n\t\t\t\t\t\t\t\treplacement: 'plugins'\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\tname = 'plugins';\n\t\t\t\t\t\t} else if (name === 'require') {\n\t\t\t\t\t\t\temit('deprecated', {\n\t\t\t\t\t\t\t\toriginal: 'require',\n\t\t\t\t\t\t\t\treplacement: 'plugins'\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\tname = 'plugins';\n\t\t\t\t\t\t} else if (name === 'requires') {\n\t\t\t\t\t\t\temit('deprecated', {\n\t\t\t\t\t\t\t\toriginal: 'requires',\n\t\t\t\t\t\t\t\treplacement: 'plugins',\n\t\t\t\t\t\t\t\tmessage: 'Set `useLoader: true`'\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\tname = 'plugins';\n\t\t\t\t\t\t\tuseLoader = true;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tresource = parseValue(\n\t\t\t\t\t\t\tname,\n\t\t\t\t\t\t\tresource,\n\t\t\t\t\t\t\t'object[]',\n\t\t\t\t\t\t\t'script'\n\t\t\t\t\t\t);\n\t\t\t\t\t\tif (useLoader) {\n\t\t\t\t\t\t\tresource.forEach((entry: PluginDescriptor) => {\n\t\t\t\t\t\t\t\tentry.useLoader = true;\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t}\n\t\t\t\t\t\tsetOption(\n\t\t\t\t\t\t\t<Config>envConfig,\n\t\t\t\t\t\t\t<keyof Config>name,\n\t\t\t\t\t\t\tresource,\n\t\t\t\t\t\t\taddToExisting\n\t\t\t\t\t\t);\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 'suites':\n\t\t\t\t\t\tresource = parseValue(name, resource, 'string[]');\n\t\t\t\t\t\tsetOption(\n\t\t\t\t\t\t\t<Config>envConfig,\n\t\t\t\t\t\t\tname,\n\t\t\t\t\t\t\tresource,\n\t\t\t\t\t\t\taddToExisting\n\t\t\t\t\t\t);\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tdefault:\n\t\t\t\t\t\tthrow new Error(\n\t\t\t\t\t\t\t`Invalid property ${key} in ${envName} config`\n\t\t\t\t\t\t);\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t} else if (name === 'functionalBaseUrl' || name === 'serverUrl') {\n\t\tsetOption(config, name, parseValue(name, value, 'string'));\n\t} else if (name === 'proxy') {\n\t\tif (value == null) {\n\t\t\tsetOption(config, name, undefined);\n\t\t} else {\n\t\t\tsetOption(config, name, parseValue(name, value, 'string'));\n\t\t}\n\t} else if (\n\t\tname === 'capabilities' ||\n\t\tname === 'instrumenterOptions' ||\n\t\tname === 'tunnelOptions'\n\t) {\n\t\tsetOption(\n\t\t\tconfig,\n\t\t\tname,\n\t\t\tparseValue(name, value, 'object'),\n\t\t\taddToExisting\n\t\t);\n\t} else if (name === 'environments') {\n\t\t// Must be a string, object, or array of (string | object)\n\t\tlet _value = value;\n\t\tif (!_value) {\n\t\t\t_value = [];\n\t\t} else if (!Array.isArray(_value)) {\n\t\t\t_value = [_value];\n\t\t}\n\t\t_value = _value.map((val: any) => {\n\t\t\tif (typeof val === 'object' && val.browserName == null) {\n\t\t\t\tval.browserName = val.browser;\n\t\t\t}\n\t\t\treturn val;\n\t\t});\n\t\tsetOption(\n\t\t\tconfig,\n\t\t\tname,\n\t\t\tparseValue(name, _value, 'object[]', 'browserName'),\n\t\t\taddToExisting\n\t\t);\n\t} else if (name === 'excludeInstrumentation') {\n\t\temit('deprecated', {\n\t\t\toriginal: 'excludeInstrumentation',\n\t\t\treplacement: 'coverage'\n\t\t});\n\t} else if (name === 'tunnel') {\n\t\tsetOption(config, name, parseValue(name, value, 'string'));\n\t} else if (\n\t\tname === 'functionalCoverage' ||\n\t\tname === 'leaveRemoteOpen' ||\n\t\tname === 'serveOnly' ||\n\t\tname === 'runInSync'\n\t) {\n\t\tsetOption(config, name, parseValue(name, value, 'boolean'));\n\t} else if (name === 'coverage') {\n\t\tlet parsed: boolean | string[];\n\t\ttry {\n\t\t\tparsed = parseValue(name, value, 'boolean');\n\t\t} catch (error) {\n\t\t\tparsed = parseValue(name, value, 'string[]');\n\t\t}\n\t\tif (typeof parsed === 'boolean' && parsed !== false) {\n\t\t\tthrow new Error(\"Non-false boolean for 'coverage'\");\n\t\t}\n\t\tsetOption(config, name, parsed);\n\t} else if (name === 'functionalSuites') {\n\t\tsetOption(\n\t\t\tconfig,\n\t\t\tname,\n\t\t\tparseValue(name, value, 'string[]'),\n\t\t\taddToExisting\n\t\t);\n\t} else if (name === 'functionalTimeouts') {\n\t\tif (!config.functionalTimeouts) {\n\t\t\tconfig.functionalTimeouts = {};\n\t\t}\n\t\tconst parsedTimeout = parseValue(name, value, 'object');\n\t\tif (parsedTimeout) {\n\t\t\t// If the given value was an object, mix it in to the\n\t\t\t// default functionalTimeouts\n\t\t\tObject.keys(parsedTimeout).forEach(timeoutKey => {\n\t\t\t\tconst key = <keyof Config['functionalTimeouts']>timeoutKey;\n\t\t\t\tconfig.functionalTimeouts[key] = parseValue(\n\t\t\t\t\t`functionalTimeouts.${key}`,\n\t\t\t\t\tparsedTimeout[key],\n\t\t\t\t\t'number'\n\t\t\t\t);\n\t\t\t});\n\t\t} else {\n\t\t\t// If the given value was null/undefined, clear out\n\t\t\t// functionalTimeouts\n\t\t\tsetOption(config, name, {});\n\t\t}\n\t} else if (\n\t\tname === 'maxConcurrency' ||\n\t\tname === 'serverPort' ||\n\t\tname === 'socketPort'\n\t) {\n\t\tsetOption(config, name, parseValue(name, value, 'number'));\n\t} else {\n\t\temit('log', `Config has unknown option \"${name}\"`);\n\t\tsetOption(config, name, value);\n\t}\n}\n\n/**\n * Remove all instances of of an item from any array and return the removed\n * instances.\n */\nexport function pullFromArray<T>(haystack: T[], needle: T): T[] {\n\tlet removed: T[] = [];\n\tlet i = 0;\n\n\twhile ((i = haystack.indexOf(needle, i)) > -1) {\n\t\tremoved.push(haystack.splice(i, 1)[0]);\n\t}\n\n\treturn removed;\n}\n\n/**\n * Remove JS-style line and block comments from a string\n */\nfunction removeComments(text: string) {\n\tlet state: 'string' | 'block-comment' | 'line-comment' | 'default' =\n\t\t'default';\n\tlet i = 0;\n\n\t// Create an array of chars from the text, the blank out anything in a\n\t// comment\n\tconst chars = text.split('');\n\n\twhile (i < chars.length) {\n\t\tswitch (state) {\n\t\t\tcase 'block-comment':\n\t\t\t\tif (chars[i] === '*' && chars[i + 1] === '/') {\n\t\t\t\t\tchars[i] = ' ';\n\t\t\t\t\tchars[i + 1] = ' ';\n\t\t\t\t\tstate = 'default';\n\t\t\t\t\ti += 2;\n\t\t\t\t} else if (chars[i] !== '\\n') {\n\t\t\t\t\tchars[i] = ' ';\n\t\t\t\t\ti += 1;\n\t\t\t\t} else {\n\t\t\t\t\ti += 1;\n\t\t\t\t}\n\t\t\t\tbreak;\n\n\t\t\tcase 'line-comment':\n\t\t\t\tif (chars[i] === '\\n') {\n\t\t\t\t\tstate = 'default';\n\t\t\t\t} else {\n\t\t\t\t\tchars[i] = ' ';\n\t\t\t\t}\n\t\t\t\ti += 1;\n\t\t\t\tbreak;\n\n\t\t\tcase 'string':\n\t\t\t\tif (chars[i] === '\"') {\n\t\t\t\t\tstate = 'default';\n\t\t\t\t\ti += 1;\n\t\t\t\t} else if (chars[i] === '\\\\' && chars[i + 1] === '\\\\') {\n\t\t\t\t\ti += 2;\n\t\t\t\t} else if (chars[i] === '\\\\' && chars[i + 1] === '\"') {\n\t\t\t\t\ti += 2;\n\t\t\t\t} else {\n\t\t\t\t\ti += 1;\n\t\t\t\t}\n\t\t\t\tbreak;\n\n\t\t\tdefault:\n\t\t\t\tif (chars[i] === '\"') {\n\t\t\t\t\tstate = 'string';\n\t\t\t\t\ti += 1;\n\t\t\t\t} else if (chars[i] === '/' && chars[i + 1] === '*') {\n\t\t\t\t\tchars[i] = ' ';\n\t\t\t\t\tchars[i + 1] = ' ';\n\t\t\t\t\tstate = 'block-comment';\n\t\t\t\t\ti += 2;\n\t\t\t\t} else if (chars[i] === '/' && chars[i + 1] === '/') {\n\t\t\t\t\tchars[i] = ' ';\n\t\t\t\t\tchars[i + 1] = ' ';\n\t\t\t\t\tstate = 'line-comment';\n\t\t\t\t\ti += 2;\n\t\t\t\t} else {\n\t\t\t\t\ti += 1;\n\t\t\t\t}\n\t\t}\n\t}\n\n\treturn chars.join('');\n}\n\n/**\n * Set an option value.\n */\nexport function setOption(\n\tconfig: Config,\n\tname: keyof Config,\n\tvalue: any,\n\taddToExisting = false\n) {\n\tif (addToExisting) {\n\t\tconst currentValue: any = config[name];\n\t\tif (currentValue == null) {\n\t\t\tconfig[name] = value;\n\t\t} else if (Array.isArray(currentValue)) {\n\t\t\tcurrentValue.push(...value);\n\t\t} else if (typeof config[name] === 'object') {\n\t\t\tconfig[name] = deepMixin({}, config[name]!, value);\n\t\t} else {\n\t\t\tthrow new Error('Only array or object options may be added');\n\t\t}\n\t} else {\n\t\tconfig[name] = value;\n\t}\n}\n\n/**\n * Split a config path into a file name and a child config name.\n *\n * This allows for the case where a file name itself may include the config\n * separator (e.g., a scoped npm package).\n */\nexport function splitConfigPath(\n\tpath: string,\n\tseparator = '/'\n): { configFile: string; childConfig?: string } {\n\tconst lastSep = path.lastIndexOf(configPathSeparator);\n\tif (lastSep === 0) {\n\t\t// path is like '@foo' -- specifies a child config\n\t\treturn { configFile: '', childConfig: path.slice(1) };\n\t}\n\tif (lastSep === -1 || path[lastSep - 1] === separator) {\n\t\t// path is like 'foo' or 'node_modules/@foo' -- specifies a\n\t\t// path\n\t\treturn { configFile: path };\n\t}\n\n\t// path is like 'foo@bar' or 'node_modules/@foo@bar' -- specifies a path and\n\t// a child config\n\treturn {\n\t\tconfigFile: path.slice(0, lastSep),\n\t\tchildConfig: path.slice(lastSep + 1)\n\t};\n}\n\n/**\n * Convert an object to JSON, handling non-primitive properties\n *\n * @param object The object to serialise.\n * @returns A JSON string\n */\nexport function stringify(object: Object, indent?: string) {\n\treturn JSON.stringify(object, serializeReplacer, indent);\n}\n\n// ============================================================================\n// support functions\n\nfunction _loadConfig(\n\tconfigPath: string,\n\tloadText: TextLoader,\n\targs?: { [key: string]: any },\n\tchildConfig?: string | string[]\n): Task<any> {\n\treturn loadText(configPath)\n\t\t.then(text => {\n\t\t\tconst preConfig = parseJson(text);\n\n\t\t\t// extends paths are assumed to be relative and use '/'\n\t\t\tif (preConfig.extends) {\n\t\t\t\tconst parts = configPath.split('/');\n\t\t\t\tconst { configFile, childConfig } = splitConfigPath(\n\t\t\t\t\tpreConfig.extends\n\t\t\t\t);\n\t\t\t\tconst extensionPath = parts\n\t\t\t\t\t.slice(0, parts.length - 1)\n\t\t\t\t\t.concat(configFile)\n\t\t\t\t\t.join('/');\n\n\t\t\t\treturn _loadConfig(\n\t\t\t\t\textensionPath,\n\t\t\t\t\tloadText,\n\t\t\t\t\tundefined,\n\t\t\t\t\tchildConfig\n\t\t\t\t).then(extension => {\n\t\t\t\t\t// Process all keys except 'configs' from the config to the\n\t\t\t\t\t// thing it's extending\n\t\t\t\t\tObject.keys(preConfig)\n\t\t\t\t\t\t.filter(key => key !== 'configs')\n\t\t\t\t\t\t.forEach(key => {\n\t\t\t\t\t\t\tprocessOption(\n\t\t\t\t\t\t\t\t<keyof Config>key,\n\t\t\t\t\t\t\t\tpreConfig[key],\n\t\t\t\t\t\t\t\textension\n\t\t\t\t\t\t\t);\n\t\t\t\t\t\t});\n\n\t\t\t\t\t// If config has a 'configs' property, mix its values into\n\t\t\t\t\t// extension.configs (slightly deeper mixin)\n\t\t\t\t\tif (preConfig.configs) {\n\t\t\t\t\t\tif (extension.configs == null) {\n\t\t\t\t\t\t\textension.configs = {};\n\t\t\t\t\t\t}\n\t\t\t\t\t\tObject.keys(preConfig.configs).forEach(key => {\n\t\t\t\t\t\t\textension.configs[key] = preConfig.configs[key];\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t\treturn extension;\n\t\t\t\t});\n\t\t\t} else {\n\t\t\t\tconst config: any = {};\n\t\t\t\tObject.keys(preConfig).forEach(key => {\n\t\t\t\t\tprocessOption(<keyof Config>key, preConfig[key], config);\n\t\t\t\t});\n\t\t\t\treturn config;\n\t\t\t}\n\t\t})\n\t\t.then(config => {\n\t\t\tif (args && (args.showConfigs || args.help)) {\n\t\t\t\t// If we're showing the configs, don't mix in children\n\t\t\t\treturn config;\n\t\t\t}\n\n\t\t\tif (childConfig) {\n\t\t\t\tconst mixinConfig = (childConfig: string | string[]) => {\n\t\t\t\t\tconst configs = Array.isArray(childConfig)\n\t\t\t\t\t\t? childConfig\n\t\t\t\t\t\t: [childConfig];\n\t\t\t\t\tconfigs.forEach(childConfig => {\n\t\t\t\t\t\tconst child = config.configs[childConfig];\n\t\t\t\t\t\tif (!child) {\n\t\t\t\t\t\t\tthrow new Error(\n\t\t\t\t\t\t\t\t`Unknown child config \"${childConfig}\"`\n\t\t\t\t\t\t\t);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (child.extends) {\n\t\t\t\t\t\t\tmixinConfig(child.extends);\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\t// Mix the child into the current config. Properties\n\t\t\t\t\t\t// other than the environment resource keys ('node' and\n\t\t\t\t\t\t// 'browser') will replace values on the parent. The\n\t\t\t\t\t\t// environment resource objects will be mixed into the\n\t\t\t\t\t\t// corresponding objects on the parent.\n\t\t\t\t\t\tObject.keys(child)\n\t\t\t\t\t\t\t.filter(key => key !== 'node' && key !== 'browser')\n\t\t\t\t\t\t\t.forEach(key => {\n\t\t\t\t\t\t\t\tprocessOption(\n\t\t\t\t\t\t\t\t\t<keyof Config>key,\n\t\t\t\t\t\t\t\t\tchild[key],\n\t\t\t\t\t\t\t\t\tconfig\n\t\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\t});\n\n\t\t\t\t\t\t['node', 'browser'].forEach(key => {\n\t\t\t\t\t\t\tif (child[key]) {\n\t\t\t\t\t\t\t\tif (config[key]) {\n\t\t\t\t\t\t\t\t\t// Run the environment config through\n\t\t\t\t\t\t\t\t\t// setOption, then mix it into the main\n\t\t\t\t\t\t\t\t\t// config\n\t\t\t\t\t\t\t\t\tconst envConfig: any = {};\n\t\t\t\t\t\t\t\t\tprocessOption(\n\t\t\t\t\t\t\t\t\t\t<keyof Config>key,\n\t\t\t\t\t\t\t\t\t\tchild[key],\n\t\t\t\t\t\t\t\t\t\tenvConfig\n\t\t\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\t\t\tmixin(config[key], envConfig[key]);\n\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\tprocessOption(\n\t\t\t\t\t\t\t\t\t\t<keyof Config>key,\n\t\t\t\t\t\t\t\t\t\tchild[key],\n\t\t\t\t\t\t\t\t\t\tconfig\n\t\t\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t});\n\t\t\t\t\t});\n\t\t\t\t};\n\n\t\t\t\tmixinConfig(childConfig);\n\t\t\t}\n\t\t\treturn config;\n\t\t})\n\t\t.then(config => {\n\t\t\tif (args) {\n\t\t\t\t// If any non-additive resources are specified in args, they\n\t\t\t\t// will apply to all environments and will override any\n\t\t\t\t// environment specific resources.\n\t\t\t\tconst resources: (keyof ResourceConfig)[] = [\n\t\t\t\t\t'plugins',\n\t\t\t\t\t'reporters',\n\t\t\t\t\t'suites'\n\t\t\t\t];\n\t\t\t\tresources\n\t\t\t\t\t.filter(resource => resource in args)\n\t\t\t\t\t.forEach(resource => {\n\t\t\t\t\t\tconst environments: (keyof Config)[] = [\n\t\t\t\t\t\t\t'node',\n\t\t\t\t\t\t\t'browser'\n\t\t\t\t\t\t];\n\t\t\t\t\t\tenvironments\n\t\t\t\t\t\t\t.filter(environment => config[environment])\n\t\t\t\t\t\t\t.forEach(environment => {\n\t\t\t\t\t\t\t\tdelete config[environment][resource];\n\t\t\t\t\t\t\t});\n\t\t\t\t\t});\n\n\t\t\t\tObject.keys(args).forEach(key => {\n\t\t\t\t\tprocessOption(<keyof Config>key, args[key], config);\n\t\t\t\t});\n\t\t\t}\n\t\t\treturn config;\n\t\t});\n}\n\nconst configPathSeparator = '@';\n\n/**\n * Replacer function used in stringify\n */\nfunction serializeReplacer(_key: string, value: any) {\n\tif (!value) {\n\t\treturn value;\n\t}\n\n\tif (value instanceof RegExp) {\n\t\treturn value.source;\n\t}\n\n\tif (typeof value === 'function') {\n\t\treturn value.toString();\n\t}\n\n\treturn value;\n}\n"]}